<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use Spatie\Permission\Models\Role;
use Spatie\Permission\Models\Permission;
use App\Models\User;
use Illuminate\Support\Facades\Hash;


class RolePermissionUserSeeder extends Seeder
{
    public function run()
    {
$permissions = [

    /* ================= الصلاحيات العامة ================= */
    'عرض إعدادات النظام',
    'تعديل إعدادات النظام',
    'نظرة عامة',

    /* ================= المستخدمين والصلاحيات ================= */
    'عرض صلاحية',
    'اضافة صلاحية',
    'تعديل صلاحية',
    'حذف صلاحية',

    'عرض مستخدم',
    'اضافة مستخدم',
    'تعديل مستخدم',
    'حذف مستخدم',

    /* ================= الهيكل الإداري ================= */
    'الهيكل الإداري',

    'عرض الإدارات',
    'اضافة إدارة',
    'تعديل إدارة',
    'حذف إدارة',

    'عرض الوظائف',
    'اضافة وظيفة',
    'تعديل وظيفة',
    'حذف وظيفة',

    /* ================= الموظفون ================= */
    'الموظفون',

    'عرض الموظفين',
    'اضافة موظف',
    'تعديل موظف',
    'حذف موظف',

    'عرض معلومات الموظف',
    'طباعة بطاقة الموظف',

    'تصدير اكسيل موظفين',
    'استيراد اكسيل موظفين',

    /* ===== مرفقات الموظف ===== */
    'عرض مرفق موظف',
    'اضافة مرفق موظف',
    'حذف مرفق موظف',
    'تحميل مرفق موظف',

    /* ===== بيانات التوظيف ===== */
    'عرض بيانات التوظيف',
    'اضافة بيانات التوظيف',
    'تعديل بيانات التوظيف',
    'حذف بيانات التوظيف',

    /* ================= حالات الموظفين ================= */
    'عرض حالات الموظفين',
    'اضافة حالة موظف',
    'تعديل حالة موظف',
    'حذف حالة موظف',

    /* ================= الحضور والانصراف ================= */
    'الحضور والانصراف',

    'عرض الحضور',
    'اضافة حضور',
    'تعديل حضور',
    'حذف حضور',

    'عرض الورديات',
    'اضافة وردية',
    'تعديل وردية',
    'حذف وردية',

    /* ===== الأذونات ===== */
    'عرض الأذونات',
    'اضافة إذن',
    'تعديل إذن',
    'حذف إذن',

    /* ===== العمل الإضافي ===== */
    'عرض العمل الإضافي',
    'اضافة عمل إضافي',
    'تعديل عمل إضافي',
    'حذف عمل إضافي',

    /* ================= الرواتب ================= */
    'الرواتب',
    'عرض الرواتب',
    'عرض كشف المرتبات',
    'اضافة كشف مرتب',
    'تعديل كشف مرتب',
    'حذف كشف مرتب',

    /* ===== البدلات ===== */
    'عرض البدلات',
    'اضافة بدل',
    'تعديل بدل',
    'حذف بدل',

    /* ===== الخصومات ===== */
    'عرض الخصومات',
    'اضافة خصم',
    'تعديل خصم',
    'حذف خصم',

    /* ===== المرفقات الخاصة بالمرتبات ===== */
    'عرض مرفق مرتب',
    'اضافة مرفق مرتب',
    'حذف مرفق مرتب',
    'تحميل مرفق مرتب',

    /* ===== التقارير ===== */
    'التقارير',
    'تقرير الحضور',
    'تقرير الموظفين',
    'تقرير البدلات',
    'تقرير الخصومات',
    'تقرير الرواتب',
    'تقرير كشف المرتبات',

    /* ================= السنين والشهور ================= */
    'إعدادات الوقت',

    'عرض السنين',
    'اضافة سنة',
    'تعديل سنة',
    'حذف سنة',

    'عرض الشهور',
    'اضافة شهر',
    'تعديل شهر',
    'حذف شهر',

    /* ================= التقارير العامة ================= */
    'عرض التقارير',

    'تقارير الموظفين',
    'تقارير الحضور',
    'تقارير الرواتب',
    'تقارير البدلات',
    'تقارير الخصومات',

    /* ================= ادارة المنشأة ================= */
    'تفاصيل المنشأة',
    'تعديل منشأة',

    /* ================= القواعد العامة ================= */
    'القاعدة العامة',
    'اضافة قاعدة تأخير',
    'تعديل قاعدة تأخير',
    'حذف قاعدة تأخير',

    /* ===== الأجهزة  ===== */
    'أجهزة البصمة',
    'عرض الأجهزة',
    'اضافة جهاز',
    'تعديل جهاز',
    'حذف جهاز',
    'اختبار اتصال الجهاز',
    'سحب بيانات الجهاز',
    'ربط الموظفين بالأجهزة',
    'عرض أجهزة البصمة',
    'ربط الأجهزة بالموظفين',
    'سحب بيانات البصمة',

    /* ===== مرفقات الحضور ===== */
    'عرض مرفقات الحضور',
    'اضافة مرفق حضور',
    'حذف مرفق حضور',
    'تحميل مرفق حضور',

    /* ===== ملاحظات الموظفين ===== */
    'عرض الملاحظات',
    'اضافة ملاحظة',
    'تعديل ملاحظة',
    'حذف ملاحظة',

    /* ===== الحضور والانصراف التفصيلي ===== */
    'حساب الخصومات اليومية',
    'سجلات الحضور',
    'الورديات',
    'ربط الموظفين بالورديات',
];



        foreach ($permissions as $permission) {
            Permission::firstOrCreate(['name' => $permission]);
        }

        // 2️⃣ الأدوار
        $roles = [
            'Admin' => $permissions, // Admin ياخد كل الصلاحيات
            'User' => [
                'عرض مستخدم', 
                
            ], // مستخدم عادي عنده صلاحيات محدودة
        ];

        foreach ($roles as $roleName => $rolePermissions) {
            $role = Role::firstOrCreate(['name' => $roleName]);
            $role->syncPermissions($rolePermissions);
        }

        // 3️⃣ إنشاء مستخدم Admin
        $admin = User::firstOrCreate(
            ['email' => 'admin@itd-eg.com'],
            [
                'name' => 'Admin',
                'password' => Hash::make('25246619'), 
                'roles_name' => 'Admin',


            ]
        );

        // ربط المستخدم بالـ Role
        $admin->assignRole('Admin');

        // مثال على مستخدم عادي
        $user = User::firstOrCreate(
            ['email' => 'user@itd-eg.com'],
            [
                'name' => 'Normal User',
                'password' => Hash::make('12345678'),
            ]
        );

        $user->assignRole('User');
    }
}
